// ========================================
// TRADUCCION MULTI-IDIOMA
// ========================================

const translations = {
  en: {
    title: "Portfolio",
    greeting: "Hi, I'm Santiago Lozano!",
    welcome: "Welcome to my portfolio",
    nav_about: "About Me",
    nav_skills: "Skills",
    nav_projects: "Projects",
    nav_contact: "Contact",
    nav_blog: "Blog",
    language_button: "üåê Language",
    about_title: "About Me",
    about_desc: "Hi! I'm a developer passionate about technology and creating innovative solutions. I love to learn and share what I know.",
    download_cv: "Download CV",
    skills_title: "Technical Skills",
    python_hours: "+250 hours",
    skills_cpp_hours: "+80 hours",
    skills_csharp_hours: "+110 hours",
    skills_html_hours: "+15 hours",
    projects_title: "Projects",
    project_earthquake_map: "Earthquake Map",
    project_earthquake_desc: "Interactive visualization of seismic data using maps.",
    project_github_stats: "GitHub Statistics",
    project_github_desc: "Page displaying charts about users, repositories, and licenses.",
    project_pvz: "Plants vs Zombies in Python",
    project_pvz_desc: "A project inspired by the famous PvZ game, developed from scratch in Python.",
    view_github: "View on GitHub",
    contact_title: "Contact",
    contact_email_label: "Your email:",
    contact_message_label: "Message:",
    contact_send: "Send",
    contact_linkedin: "LinkedIn",
    contact_github: "GitHub",
    contact_email: "Email",
    footer_text: "¬© 2025 My Portfolio",
    ai_title: "Virtual Assistant",
    ai_placeholder: "Ask me about Santiago...",

    // Traducciones para el blog
    comments_title: "Comments",
    reply_button: "Reply",
    no_comments: "No comments yet.",
    add_comment_title: "Add Comment",
    publish_button: "Publish",
    login_to_comment: "You must",
    login_link: "log in",
    to_comment: "to comment.",
    form_label_texto: "Text",
    form_placeholder_texto: "Write your comment...",
    blog_title: "Personal Blog",
    no_entries: "No entries found.",
    video_not_supported: "Your browser does not support the video tag.",
    audio_not_supported: "Your browser does not support the audio tag.",
    download_attachment_link: "Download attachment",
    login_title: "Login",
    login_button: "Login",
    login_no_account: "Don't have an account?",
    login_register_link: "Register",
    register_title: "Register",
    register_submit: "Register",
    register_have_account: "Already have an account?",
    register_login_link: "Login",
    logout_button: "Logout",
    Read_more: "Read more...",
    Read_less: "Read less"
  },
  es: {
    title: "Portfolio",
    greeting: "¬°Hola, soy Santiago Lozano!",
    welcome: "Bienvenido a mi portafolio",
    nav_about: "Sobre mi",
    nav_skills: "Habilidades",
    nav_projects: "Proyectos",
    nav_contact: "Contacto",
    nav_blog: "Blog",
    language_button: "üåê Idioma",
    about_title: "Sobre mi",
    about_desc: "¬°Hola! Soy un desarrollador apasionado por la tecnologia y la creacion de soluciones innovadoras. Me encanta aprender y compartir lo que se.",
    download_cv: "Descargar CV",
    skills_title: "Habilidades Tecnicas",
    python_hours: "+250 horas",
    skills_cpp_hours: "+80 horas",
    skills_csharp_hours: "+110 horas",
    skills_html_hours: "+15 horas",
    projects_title: "Proyectos",
    project_earthquake_map: "Mapa de Terremotos",
    project_earthquake_desc: "Visualizacion interactiva de datos sismicos usando mapas.",
    project_github_stats: "Estadisticas de GitHub",
    project_github_desc: "Pagina que muestra graficos sobre usuarios, repositorios y licencias.",
    project_pvz: "Plantas contra Zombies en Python",
    project_pvz_desc: "Un proyecto inspirado en el famoso juego PvZ, desarrollado desde cero en Python.",
    view_github: "Ver en GitHub",
    contact_title: "Contacto",
    contact_email_label: "Tu correo:",
    contact_message_label: "Mensaje:",
    contact_send: "Enviar",
    contact_linkedin: "LinkedIn",
    contact_github: "GitHub",
    contact_email: "Email",
    footer_text: "¬© 2025 Mi Portfolio",
    ai_title: "Asistente Virtual",
    ai_placeholder: "Preg√∫ntame sobre Santiago...",

    // Traducciones para el blog
    comments_title: "Comentarios",
    reply_button: "Responder",
    no_comments: "No hay comentarios a√∫n.",
    add_comment_title: "Agregar comentario",
    publish_button: "Publicar",
    login_to_comment: "Debes",
    login_link: "iniciar sesi√≥n",
    to_comment: "para comentar.",
    form_label_texto: "Texto",
    form_placeholder_texto: "Escribe tu comentario...",
    blog_title: "Blog Personal",
    no_entries: "No se encontraron entradas.",
    video_not_supported: "Tu navegador no soporta el elemento de video.",
    audio_not_supported: "Tu navegador no soporta el elemento de audio.",
    download_attachment_link: "Descargar adjunto",
    login_title:" Iniciar sesi√≥n",
    login_button:"Entrar",
    login_no_account:"¬øNo tienes una cuenta?",
    login_register_link: "Registrarse",
    register_title: "Registro",
    register_submit: "Registrarse",
    register_have_account: "¬øYa tienes una cuenta?",
    register_login_link: "Iniciar sesi√≥n",
    logout_button: "Cerrar sesi√≥n",
    Read_more: "Leer m√°s...",
    Read_less: "Leer menos"
  },
  zh: {
    title: "‰ΩúÂìÅÈõÜ",
    greeting: "‰Ω†Â•ΩÔºåÊàëÊòØ Santiago Lozano!",
    welcome: "Ê¨¢ËøéÊù•Âà∞ÊàëÁöÑ‰ΩúÂìÅÈõÜ",
    nav_about: "ÂÖ≥‰∫éÊàë",
    nav_skills: "ÊäÄËÉΩ",
    nav_projects: "È°πÁõÆ",
    nav_contact: "ËÅîÁ≥ª",
    nav_blog: "ÂçöÂÆ¢",
    language_button: "üåê ËØ≠Ë®Ä",
    about_title: "ÂÖ≥‰∫éÊàë",
    about_desc: "‰Ω†Â•ΩÔºÅÊàëÊòØ‰∏Ä‰∏™ÁÉ≠Áà±ÊäÄÊúØÂπ∂Ëá¥Âäõ‰∫éÂàõÈÄ†ÂàõÊñ∞Ëß£ÂÜ≥ÊñπÊ°àÁöÑÂºÄÂèëËÄÖ„ÄÇÊàëÂñúÊ¨¢Â≠¶‰π†Âπ∂ÂàÜ‰∫´ÊàëÁöÑÁü•ËØÜ„ÄÇ",
    download_cv: "‰∏ãËΩΩÁÆÄÂéÜ",
    skills_title: "ÊäÄÊúØÊäÄËÉΩ",
    python_hours: "+250 Â∞èÊó∂",
    skills_cpp_hours: "+80 Â∞èÊó∂",
    skills_csharp_hours: "+110 Â∞èÊó∂",
    skills_html_hours: "+15 Â∞èÊó∂",
    projects_title: "È°πÁõÆ",
    project_earthquake_map: "Âú∞ÈúáÂú∞Âõæ",
    project_earthquake_desc: "‰ΩøÁî®Âú∞Âõæ‰∫§‰∫íÂºèÂèØËßÜÂåñÂú∞ÈúáÊï∞ÊçÆ„ÄÇ",
    project_github_stats: "GitHub ÁªüËÆ°",
    project_github_desc: "ÊòæÁ§∫Áî®Êà∑„ÄÅ‰ªìÂ∫ìÂíåËÆ∏ÂèØËØÅÂõæË°®ÁöÑÈ°µÈù¢„ÄÇ",
    project_pvz: "Python ÁâàÊ§çÁâ©Â§ßÊàòÂÉµÂ∞∏",
    project_pvz_desc: "‰∏Ä‰∏™Âèó PvZ ÂêØÂèëÁöÑÈ°πÁõÆÔºåÁî® Python ‰ªéÈõ∂ÂºÄÂèë„ÄÇ",
    view_github: "Êü•Áúã GitHub",
    contact_title: "ËÅîÁ≥ª",
    contact_email_label: "‰Ω†ÁöÑÈÇÆÁÆ±:",
    contact_message_label: "ÁïôË®Ä:",
    contact_send: "ÂèëÈÄÅ",
    contact_linkedin: "È¢ÜËã±",
    contact_github: "GitHub",
    contact_email: "ÁîµÂ≠êÈÇÆ‰ª∂",
    footer_text: "¬© 2025 ÊàëÁöÑ‰ΩúÂìÅÈõÜ",
    ai_title: "ËôöÊãüÂä©Êâã",
    ai_placeholder: "ËØ¢ÈóÆÊàëÂÖ≥‰∫éSantiago...",

    // Traducciones para el blog
    comments_title: "ËØÑËÆ∫",
    reply_button: "ÂõûÂ§ç",
    no_comments: "ÊöÇÊó†ËØÑËÆ∫„ÄÇ",
    add_comment_title: "Ê∑ªÂä†ËØÑËÆ∫",
    publish_button: "ÂèëÂ∏É",
    login_to_comment: "‰Ω†ÂøÖÈ°ª",
    login_link: "ÁôªÂΩï",
    to_comment: "ÊâçËÉΩËØÑËÆ∫„ÄÇ",
    form_label_texto: "ÂÜÖÂÆπ",
    form_placeholder_texto: "ÂÜô‰∏ã‰Ω†ÁöÑËØÑËÆ∫...",
    blog_title: "‰∏™‰∫∫ÂçöÂÆ¢",
    no_entries: "Ê≤°ÊúâÊâæÂà∞Êù°ÁõÆ„ÄÇ",
    video_not_supported: "ÊÇ®ÁöÑÊµèËßàÂô®‰∏çÊîØÊåÅËßÜÈ¢ëÊ†áÁ≠æ„ÄÇ",
    audio_not_supported: "ÊÇ®ÁöÑÊµèËßàÂô®‰∏çÊîØÊåÅÈü≥È¢ëÊ†áÁ≠æ„ÄÇ",
    download_attachment_link: "‰∏ãËΩΩÈôÑ‰ª∂",
    login_title: "ÁôªÂΩï",
    login_button: "ÁôªÂΩï",
    login_no_account: "ËøòÊ≤°ÊúâË¥¶Âè∑Ôºü",
    login_register_link: "Ê≥®ÂÜå",
    register_title: "Ê≥®ÂÜå",
    register_submit: "Ê≥®ÂÜå",
    register_have_account: "Â∑≤ÊúâË¥¶Âè∑Ôºü",
    register_login_link: "ÁôªÂΩï",
    logout_button: "ÈÄÄÂá∫ÁôªÂΩï",
    Read_more: "ÈòÖËØªÊõ¥Â§ö...",
    Read_less: "ÈòÖËØªÊõ¥Â∞ë"
  }
};

function translatePage(lang) {
  const elements = document.querySelectorAll("[data-i18n]");
  elements.forEach(el => {
    const key = el.getAttribute("data-i18n");
    if (translations[lang] && translations[lang][key]) {
      el.textContent = translations[lang][key];
    }
  });

  actualizarComentariosIdioma(lang);
}

// Funcion para construir o reconstruir los comentarios con textos traducidos
function actualizarComentariosIdioma(lang) {
  const limite = 500;

  document.querySelectorAll('.comentario-texto').forEach(span => {
    let textoCompleto = span.textContent.trim();
    textoCompleto = textoCompleto.replace(/Leer m√°s...|Leer menos|Read more...|Read less|ÈòÖËØªÊõ¥Â§ö...|ÈòÖËØªÊõ¥Â∞ë/gi, '').trim();

    if (textoCompleto.length > limite) {
      const visible = textoCompleto.slice(0, limite);
      const oculto = textoCompleto.slice(limite);
      const leerMas = translations[lang]?.Read_more || "Leer m√°s...";
      const leerMenos = translations[lang]?.Read_less || "Leer menos";
      span.innerHTML = `
        <span class="comentario-visible">${visible}</span>
        <span class="comentario-oculto" style="display:none;">${oculto}</span>
        <button class="comentario-toggle" style="border:none; background:none; color:var(--accent-color); cursor:pointer; font-weight:bold;">
          ${leerMas}
        </button>
      `;

      const boton = span.querySelector('.comentario-toggle');
      const ocultoSpan = span.querySelector('.comentario-oculto');
      const visibleSpan = span.querySelector('.comentario-visible');
      boton.addEventListener('click', () => {
        const expandido = ocultoSpan.style.display === 'inline';
        ocultoSpan.style.display = expandido ? 'none' : 'inline';
        boton.textContent = expandido ? leerMas : leerMenos;
        if (!expandido) {
          visibleSpan.style.display = 'inline';
        }
      });
    }
  });
}

// Inicializar traduccion con idioma guardado o espa√±ol por defecto
const idiomaGuardado = localStorage.getItem('idioma') || 'es';
translatePage(idiomaGuardado);

document.getElementById('botonIdioma').addEventListener('click', e => {
  e.stopPropagation();
  document.getElementById('listaIdiomas').classList.toggle('mostrar');
});

document.addEventListener('click', () => {
  document.getElementById('listaIdiomas').classList.remove('mostrar');
});

document.querySelectorAll('#listaIdiomas li').forEach(item => {
  item.addEventListener('click', function () {
    const lang = this.getAttribute('data-lang');
    translatePage(lang);
    localStorage.setItem('idioma', lang);
    document.getElementById('listaIdiomas').classList.remove('mostrar');
  });
});